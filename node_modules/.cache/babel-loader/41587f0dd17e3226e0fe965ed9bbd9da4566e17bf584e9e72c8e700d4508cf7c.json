{"ast":null,"code":"// src/components/Payment.js\nimport React,{useState,useEffect}from'react';import{Container,Typography,Button,Alert}from'@mui/material';import{CardElement,useStripe,useElements}from'@stripe/react-stripe-js';import axios from'axios';import{useNavigate}from'react-router-dom';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Payment=_ref=>{let{requestId,amount}=_ref;const stripe=useStripe();const elements=useElements();const navigate=useNavigate();const[clientSecret,setClientSecret]=useState('');const[error,setError]=useState('');const[success,setSuccess]=useState('');useEffect(()=>{const fetchClientSecret=async()=>{try{const response=await axios.post(`${process.env.REACT_APP_BACKEND_URL}/api/payments/create-payment-intent`,{requestId},{headers:{'x-auth-token':localStorage.getItem('token')}});setClientSecret(response.data.clientSecret);}catch(err){setError('Error initializing payment');}};fetchClientSecret();},[requestId]);const handleSubmit=async e=>{e.preventDefault();if(!stripe||!elements)return;const cardElement=elements.getElement(CardElement);const{error,paymentIntent}=await stripe.confirmCardPayment(clientSecret,{payment_method:{card:cardElement}});if(error){setError(error.message);}else if(paymentIntent.status==='succeeded'){setSuccess('Payment successful!');setTimeout(()=>navigate('/client-dashboard'),2000);}};return/*#__PURE__*/_jsxs(Container,{maxWidth:\"sm\",style:{marginTop:'2rem'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,children:\"Make Payment\"}),/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",children:[\"Amount: $\",amount]}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:error}),success&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",children:success}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(CardElement,{options:{style:{base:{fontSize:'16px',color:'#424770','::placeholder':{color:'#aab7c4'}},invalid:{color:'#9e2146'}}}}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",fullWidth:true,disabled:!stripe||!clientSecret,style:{marginTop:'1rem'},children:\"Pay\"})]})]});};export default Payment;","map":{"version":3,"names":["React","useState","useEffect","Container","Typography","Button","Alert","CardElement","useStripe","useElements","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","Payment","_ref","requestId","amount","stripe","elements","navigate","clientSecret","setClientSecret","error","setError","success","setSuccess","fetchClientSecret","response","post","process","env","REACT_APP_BACKEND_URL","headers","localStorage","getItem","data","err","handleSubmit","e","preventDefault","cardElement","getElement","paymentIntent","confirmCardPayment","payment_method","card","message","status","setTimeout","maxWidth","style","marginTop","children","variant","gutterBottom","severity","onSubmit","options","base","fontSize","color","invalid","type","fullWidth","disabled"],"sources":["/Users/macm1/Documents/JobSkill-App/frontend/src/components/Payment.js"],"sourcesContent":["// src/components/Payment.js\nimport React, { useState, useEffect } from 'react';\nimport { Container, Typography, Button, Alert } from '@mui/material';\nimport { CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\n\nconst Payment = ({ requestId, amount }) => {\n  const stripe = useStripe();\n  const elements = useElements();\n  const navigate = useNavigate();\n  const [clientSecret, setClientSecret] = useState('');\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState('');\n\n  useEffect(() => {\n    const fetchClientSecret = async () => {\n      try {\n        const response = await axios.post(\n          `${process.env.REACT_APP_BACKEND_URL}/api/payments/create-payment-intent`,\n          { requestId },\n          { headers: { 'x-auth-token': localStorage.getItem('token') } }\n        );\n        setClientSecret(response.data.clientSecret);\n      } catch (err) {\n        setError('Error initializing payment');\n      }\n    };\n    fetchClientSecret();\n  }, [requestId]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!stripe || !elements) return;\n\n    const cardElement = elements.getElement(CardElement);\n    const { error, paymentIntent } = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: cardElement,\n      },\n    });\n\n    if (error) {\n      setError(error.message);\n    } else if (paymentIntent.status === 'succeeded') {\n      setSuccess('Payment successful!');\n      setTimeout(() => navigate('/client-dashboard'), 2000);\n    }\n  };\n\n  return (\n    <Container maxWidth=\"sm\" style={{ marginTop: '2rem' }}>\n      <Typography variant=\"h4\" gutterBottom>\n        Make Payment\n      </Typography>\n      <Typography variant=\"h6\">Amount: ${amount}</Typography>\n      {error && <Alert severity=\"error\">{error}</Alert>}\n      {success && <Alert severity=\"success\">{success}</Alert>}\n      <form onSubmit={handleSubmit}>\n        <CardElement\n          options={{\n            style: {\n              base: {\n                fontSize: '16px',\n                color: '#424770',\n                '::placeholder': { color: '#aab7c4' },\n              },\n              invalid: { color: '#9e2146' },\n            },\n          }}\n        />\n        <Button\n          type=\"submit\"\n          variant=\"contained\"\n          color=\"primary\"\n          fullWidth\n          disabled={!stripe || !clientSecret}\n          style={{ marginTop: '1rem' }}\n        >\n          Pay\n        </Button>\n      </form>\n    </Container>\n  );\n};\n\nexport default Payment;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}